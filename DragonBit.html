
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>Dragon Bit Version 1.7</title>
<style>
  /*table, tr, td, div {border:1px solid red; }*/

  table {
    font-family: verdana,arial,sans-serif;
    font-size:11px;
    color:#333333;
    border-width: 1px;
    border-color: #666666;
    border-collapse: collapse;
  }
  table th {
    border-width: 1px;
    padding: 8px;
    border-style: solid;
    border-color: #666666;
    background-color: #dedede;
  }
  table td {
    border-width: 1px;
    padding: 8px;
    border-style: solid;
    border-color: #666666;
    background-color: #ffffff;
  }

  #powertable, #defensivetable {display: none;}
</style>
<body>

<table id='powertable' cellpadding='0' cellpadding='0'>
  <tr>
    <td><button id='power1'>Hit</button></td>
    <td><button id='power2'>ERROR</button></td>
  </tr>
</table>

<table id='defensivetable' cellpadding='0' cellpadding='0'>
  <tr>
    <th><button id='potionUse'>Use Potion</button></td>
  </tr>
</table>

<table id="classtable" cellpadding="0" cellpadding="0">
  <tr>
    <th>Class</th>
    <th>&nbsp;</th>
    <th>&nbsp;</th>
    <th>Discription</th>
    <th>Selection</th>
  </tr>
  <tr>
    <td>Scout</td>
    <td>2 AP</td>
    <td>0 AC</td>
    <td>&nbsp;</td>
    <td><input id="Scout" type = "button" value = "Chose Scout"></td>
  </tr>
    <td>Marshall</td>
    <td>3 AC</td>
    <td>0 AP</td>
    <td>&nbsp;</td>
    <td><input id="Marshall" type = "button" value = "Chose Marshall"></td>
  </tr>
  <tr>
    <td>QuickStep</td>
    <td>0 AC</td>
    <td>0 AP</td>
    <td>Nimble: Hits twice, with second hit doing half</td>
    <td><input id="Quickstep" type = "button" value = "Chose QuickStep" /></td>
  </tr>
</table>  

<table id="turntable" cellpadding="0" cellpadding="0">
  <tr>
    <td>Player HP</td>
    <td>&nbsp;</td>
    <td>Enemy HP </td>
  </tr>
  <tr>
    <td><input id ="reset" type = "button" value = " Reset "></td>
    <td><input id='attack' type='button' value='Offensive' ></td>
    <td><input id="defense" type="button" value="Defensive"></td>
  </tr>
  <tr>
    <td id='PlayerHealth'></td>
    <td>&nbsp;</td>
    <td id='NPCHealth'></td>
  </tr>
</table>

<div id='log' cols='20' rows='10'  ></div>

</body>

<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script>
Defensive = function(){
  $("#turntable").hide();
  $("#defensivetable").show();
  $("#potionUse").on("click", PotionUse);

}
//creation of player and NPC objects
dragonObj=new Object;
currentNPC ="ERROR"
currentNPCRandomizer = Math.floor((Math.random)()*2 +1)

ninjaObj = {
  armorclass: 1,  
  health: 10,
  go: true,
  hitmiss: (Math.random)(),
  damage: Math.floor((Math.random)()*2) + 1,
  register: "Ninja",
  armorpen: 2,
  alignment: "Evil"
};

dragonObj.register = "Dragon"
dragonObj.armorpen = 0
dragonObj.health = 15;
dragonObj.go = true
dragonObj.armorclass = 1

if(currentNPCRandomizer == 1){
  currentNPC = ninjaObj
}
else{
  currentNPC = dragonObj
}

$NPCHealthText = document.getElementById("NPCHealth");
$NPCHealthText.innerHTML += currentNPC.health;
dragonObj.hitmiss = (Math.random)()
dragonObj.damage = Math.floor((Math.random)()*2 +1);
dragonObj.alignment = "Evil"
playerObj=new Object;
playerObj.register = "You"
playerObj.alignment = "Good"

//setup for buttons, press all da buttons!
$(document).ready(function(){
  $("#Marshall").on("click", marshallSel);
  $("#turntable").hide();
  $("#Quickstep").on("click", quickstepSel);
  $("#Scout").on("click", scoutSel);
  $("#attack").on("click", attacksetup);
  $("#reset").on("click", reset);
  $("#powertable").hide()
  $("#defensivetable").hide()
  $("#defense").on("click", Defensive)
 });
//log function to replace stupid use of console.log, curse you CA!!!
log = function (input, colorChoice) {
   $('#log').prepend("<p style='color:" + colorChoice + "'>" + input + "</p>");
}; 
log("You are fighting a " + currentNPC.register)
//if normal everyday dull class selected
//set player vars to:
quickstepSel = function(){
playerObj.potioncount = 1
classOfPlayer = 1
playerObj.health = 7
playerObj.hitmiss = (Math.random)();
playerObj.damage = Math.floor((Math.random)() *2 +1) + Math.floor((Math.random)() *2 +1 /2);
$PlayerHealthText = document.getElementById("PlayerHealth");
$PlayerHealthText.innerHTML += playerObj.health;
//playerObj.quickstepDamage = Math.floor((Math.random)() *2 +1) + Math.floor((Math.random)() *2 +1 /2)
playerObj.armorclass = 0
playerObj.armorpen = 0
$("#turntable").show()
$("#classtable").hide()
$("#potionUse").on("click", Defensive)
}

//if marshall selected
//set player vars to:
marshallSel = function(){
playerObj.armorpen = 0
playerObj.armorclass = 3
playerObj.potioncount = 1
classOfPlayer = 2
playerObj.health = 10;
playerObj.hitmiss = (Math.random)();
playerObj.damage = Math.floor((Math.random)() *2 +1) - .5;
$PlayerHealthText = document.getElementById("PlayerHealth");
$PlayerHealthText.innerHTML += playerObj.health;
//playerObj.marshallDamage = Math.floor((Math.random)() *2 +1) - .5
$("#turntable").show()
$("#classtable").hide()
$("#potionUse").on("click", Defensive)
$("#power2").hide()
}

//if scout selected
//set player vars to:
scoutSel = function(){
playerObj.potioncount = 1
playerObj.armorclass = 0
playerObj.armorpen = 2
classOfPlayer = 3
playerObj.health = 10;
playerObj.hitmiss = (Math.random)();
playerObj.damage = Math.floor((Math.random)() *2 +1) ;
$PlayerHealthText = document.getElementById("PlayerHealth");
$PlayerHealthText.innerHTML += playerObj.health;
//playerObj.scoutDamage = Math.floor((Math.random)() *2 +1)
$("#turntable").show()
$("#classtable").hide()
$("#potionUse").on("click", Defensive)
}


PotionUse = function (){
  $("#attack").hide()
  if(playerObj.potioncount >= 1){
    playerObj.potioncount = playerObj.potioncount - 1
    if(playerObj.potioncount >= 0){
      $("#defensivetable").hide()
    }
    playerObj.health = playerObj.health + 5
    $("#PlayerHealth").empty();
    $PlayerHealthText.innerHTML += playerObj.health;
    log("You gained 5 health!")
    redo = false
    attack(currentNPC, playerObj)
    $("#turntable").show()
    }
  else if(playerObj.potioncount <= 0){
    log("You have no potions to use")
    $("#turntable").show()
  }
}



rerandomize = function(){
  dragonObj.hitmiss = (Math.random)();
  dragonObj.damage = Math.floor((Math.random)() *2 + 1);
  playerObj.hitmiss = (Math.random)()
  playerObj.damage = playerObj.damage
  ninjaObj.hitmiss = (Math.random)();
  ninjaObj.damage = Math.floor((Math.random)()*2 +1);
}

attacksetup = function(customsel1, customsel2){
  redo = true
  attack(playerObj, currentNPC)
}

//attack funtion, main game logic storage
attack = function(attacker, defender){
  if(attacker.hitmiss >= .25){
    $("#attack").hide()
    if(attacker.armorpen > defender.armorclass){
      attacker.damage = attacker.damage + defender.armorclass
      defender.health = defender.health - attacker.damage
    }
    else{
      attacker.damage = attacker.damage + attacker.armorpen
      defender.armorclass = defender.armorclass - attacker.armorpen
      defender.health = defender.health - attacker.damage - defender.armorclass
    }
    log(attacker.register + " hit for " + attacker.damage)
    rerandomize()
    $("#PlayerHealth").empty()
    $PlayerHealthText.innerHTML += playerObj.health;
    $("#NPCHealth").empty()
    $NPCHealthText.innerHTML += currentNPC.health;
    if(defender.health <= 0){
      if(defender.alignment == "Evil"){
        alert("You deafeated the " + defender.register + "!")
        alert("The game will now reset")
        reset()
      }
      else{
        alert("You were slain!")
        alert("The game will now reset")
        reset()

      }
    }
    $("#attack").show()
    if(redo == true){
      redo = false
      attack(defender, attacker)
    }
  }
  else{
    rerandomize()
    log(attacker.register + " missed!")
    if(redo == true){
      redo = false
      attack(defender, attacker)
    }
    $("#attack").show()
  }
}
      
reset = function(){
  location.reload()
};
debug = function(){
  console.log("WARNING, this is for developing purposes and breaks game")
  $("#defensivetable").show()
  $("powertable").show()
  $("#turntable").show()
  $("classtable").show()
}
</script>

</head>

</html>